apiVersion: triggers.tekton.dev/v1beta1
kind: TriggerTemplate
metadata:
  name: gcp-region-template
spec:
  params:
    # Parameters received from the TriggerBinding
    - name: environment
      description: "Target environment (production, staging, integration)"
    - name: region
      description: "GCP region to provision"
    - name: sector
      description: "Deployment sector (max 40 chars)"
  resourcetemplates:
    - apiVersion: tekton.dev/v1beta1
      kind: PipelineRun
      metadata:
        generateName: gcp-region-provision-
      spec:
        # Use Workload Identity-enabled service account for GCP access
        serviceAccountName: tekton-gcp-deployer
        pipelineRef:
          name: gcp-region-provisioning-pipeline
        # Workspace configuration - using PersistentVolumeClaim for shared storage
        workspaces:
          - name: shared-data
            persistentVolumeClaim:
              claimName: tekton-workspace-pvc
        params:
          - name: environment
            value: $(tt.params.environment)
          - name: region
            value: $(tt.params.region)
          - name: sector
            value: $(tt.params.sector)
